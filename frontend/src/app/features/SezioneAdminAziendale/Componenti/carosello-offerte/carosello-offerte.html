@if (offerte.length > 0) {
  <div class="relative w-full overflow-hidden rounded-[2rem] group h-[380px] shadow-xl animate-fade-right animate-duration-1000 animate-delay-800">

    @for (off of offerte; track off.idOfferta; let i = $index) {
      <div class="absolute inset-0 transition-all duration-700 ease-in-out transform"
           [class.opacity-100]="i === indiceCorrente"
           [class.z-10]="i === indiceCorrente"
           [class.opacity-0]="i !== indiceCorrente"
           [class.scale-105]="i !== indiceCorrente">

        <img [src]="off.immagineCopertina || 'assets/placeholder-car.jpg'"
             class="absolute inset-0 w-full h-full object-cover"
             alt="Offerta">

        <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/40 to-transparent"></div>
        <div class="absolute bottom-0 left-0 p-8 w-full z-20">
          <div class="flex flex-col gap-3 animate-in fade-in slide-in-from-bottom-5 duration-700">

            <div class="flex items-center gap-3">
               <span class="px-3 py-1 bg-azzurro text-white text-sm font-black rounded-full shadow-lg shadow-azzurro/30">
                 -{{ off.percentualeSconto }}%
               </span>
              <span class="text-white/70 text-xs font-bold uppercase tracking-widest">Offerta Esclusiva</span>
            </div>

            <h3 class="text-3xl md:text-4xl font-black text-white tracking-tighter">
              {{ off.nomeOfferta }}
            </h3>

            <p class="text-white/80 text-sm md:text-base max-w-xl line-clamp-2 italic font-medium">
              "{{ off.descrizioneOfferta }}"
            </p>

            <div class="mt-4">
              <button (click)="richiediDettagli(off)"
                      class="px-8 py-3 bg-white text-blu-notte hover:bg-azzurro hover:text-white font-bold rounded-full transition-all duration-300 transform active:scale-95 shadow-xl">
                Vedi Dettagli
              </button>
            </div>
          </div>
        </div>
      </div>
    }

    <button (click)="arretraCarosello()"
            class="absolute left-4 top-1/2 -translate-y-1/2 z-30 w-12 h-12 flex items-center justify-center rounded-full bg-white/10 backdrop-blur-md border border-white/20 text-white opacity-0 group-hover:opacity-100 transition-all duration-300 hover:bg-white/30">
      <i class="bi bi-chevron-left text-xl"></i>
    </button>

    <button (click)="avanzaCarosello()"
            class="absolute right-4 top-1/2 -translate-y-1/2 z-30 w-12 h-12 flex items-center justify-center rounded-full bg-white/10 backdrop-blur-md border border-white/20 text-white opacity-0 group-hover:opacity-100 transition-all duration-300 hover:bg-white/30">
      <i class="bi bi-chevron-right text-xl"></i>
    </button>

    <div class="absolute bottom-6 right-8 z-30 flex gap-2">
      @for (off of offerte; track off.idOfferta; let i = $index) {
        <span (click)="vaiAdOffertaSpecifica(i)"
              class="h-1.5 rounded-full transition-all duration-500 cursor-pointer shadow-sm"
              [class.w-8]="i === indiceCorrente"
              [class.bg-white]="i === indiceCorrente"
              [class.w-2]="i !== indiceCorrente"
              [class.bg-white/40]="i !== indiceCorrente">
        </span>
      }
    </div>

  </div>
} @else {
  <div class="w-full h-40 flex flex-col items-center justify-center bg-grigio rounded-3xl border-2 border-dashed border-testo-s/20">
    <i class="bi bi-tag text-3xl text-testo-s/40 mb-2"></i>
    <p class="text-testo-s font-medium italic">Nessuna offerta attiva al momento.</p>
  </div>
}
