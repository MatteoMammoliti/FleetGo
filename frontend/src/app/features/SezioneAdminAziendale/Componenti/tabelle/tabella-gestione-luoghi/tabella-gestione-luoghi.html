<div class="bg-white mt-2 rounded-2xl shadow-sm border border-slate-200 overflow-hidden flex flex-col h-[395px]">
  <div class="py-3 px-6 border-b border-slate-100 bg-slate-50/50">
    <h3 class="text-lg font-bold text-slate-800 flex items-center gap-2">
      <i class="bi bi-list-check text-blue-600"></i> Gestione Sedi
    </h3>
    <p class="text-sm text-slate-500 mt-1">Seleziona la sede operativa o gestisci i tuoi luoghi.</p>
  </div>

  <div class="overflow-y-auto flex-1 p-0">
    @if (luoghi.length === 0) {
      <div class="flex flex-col items-center justify-center h-64 text-slate-400 p-6 text-center">
        <div class="w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mb-4 text-2xl">
          <i class="bi bi-geo-alt"></i>
        </div>
        <p class="font-medium">Nessun luogo salvato</p>
        <p class="text-sm mt-1">Aggiungi un nuovo indirizzo usando la mappa qui sotto.</p>
      </div>
    } @else {
      <table class="w-full text-left text-sm border-collapse">
        <thead class="bg-slate-50 text-slate-500 font-semibold sticky top-0 z-10">
        <tr>
          <th class="px-6 py-4">Nome Luogo</th>
          <th class="px-6 py-4 text-center">Stato</th>
          <th class="px-6 py-4 text-right">Azioni</th>
        </tr>
        </thead>
        <tbody class="divide-y divide-slate-100" [@animazioneTabella]="luoghi.length">
          @for (luogo of luoghi; track luogo.idLuogo) {
            <tr class="hover:bg-blue-50/30 transition-colors">
              <td class="px-6 py-4 font-medium text-slate-700">
                {{ luogo.nomeLuogo }}
              </td>

              <td class="px-6 py-4 text-center">
                @if (nomeSedeAttuale === luogo.nomeLuogo) {
                  <span
                    class="inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-bold bg-green-100 text-green-700 border border-green-200">
                    <i class="bi bi-check-circle-fill"></i> Sede Legale
                  </span>
                } @else {
                  <button (click)="impostaSede.emit(luogo.idLuogo)"
                          class="text-xs font-semibold text-slate-500 hover:text-blue-600 hover:bg-blue-50 px-3 py-1 rounded-full border border-slate-200 hover:border-blue-200 transition-all">
                    Imposta come Sede
                  </button>
                }
              </td>

              <td class="px-6 py-4 text-right">
                @if (nomeSedeAttuale != luogo.nomeLuogo) {
                  <button (click)="eliminaLuogo.emit(luogo.idLuogo)"
                          type="button"
                          class="relative z-30 w-8 h-8 rounded-lg flex items-center justify-center text-slate-400 hover:text-red-600 hover:bg-red-50 transition-all ml-auto cursor-pointer"
                          title="Elimina luogo">
                    <i class="bi bi-trash3 pointer-events-none"></i>
                  </button>
                }
              </td>
            </tr>
          }
        </tbody>
      </table>
    }
  </div>
</div>
