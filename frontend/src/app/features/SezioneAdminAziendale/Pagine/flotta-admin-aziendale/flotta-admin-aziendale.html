<app-template-titolo-sottotitolo titolo="Flotta Aziendale" sottotitolo="GESTISCI LA TUA FLOTTA AZIENDALE">
  <div class="h-[600px] ">
    <div class="flex flex-col gap-8 animate-fade-up animate-duration-1000">
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-white px-4 pt-2 rounded-2xl shadow-sm border border-slate-100">
      <div class="flex flex-col gap-2">
        <div class="flex gap-3 text-sm bg-azzurro-scuro text-gray-100 p-2 rounded-xl pt-1">
          <div class="flex items-center gap-2 ">
            <span class="w-2 h-2 rounded-full bg-green-500"></span>
            <span class="font-bold">{{ getConteggio('DISPONIBILE') }}</span> Disponibili
          </div>
          <div class="flex items-center gap-2 ">
            <span class="w-2 h-2 rounded-full bg-yellow-400"></span>
            <span class="font-bold">{{ getConteggio('MANUTENZIONE') }}</span> Manutenzione
          </div>
          <div class="flex items-center gap-2 ">
            <span class="w-2 h-2 rounded-full bg-red-500"></span>
            <span class="font-bold">{{ getConteggio('SENZALUOGO') }}</span> Senza luogo
          </div>
        </div>

      </div>


      <div class="flex flex-col md:flex-row gap-3 w-full md:w-auto">
        <div class="relative w-full md:w-64">
          <app-input-checked
            [titolo]="'Cerca'"
            [placeholder]="'Cerca targa o modello...'"
            [(valore)]="testoRicerca"
            (valoreChange)="testoRicerca = $event">
          </app-input-checked>
        </div>

        <div class="relative w-full md:w-48">
            <app-scelta-tendina
              [titolo]="'Filtra Stato'"
              [placeholder]="'Tutti gli stati'"
              [lista]="['DISPONIBILE', 'MANUTENZIONE', 'SENZALUOGO']"
              [(valore)]="filtroStato"
              (valoreChange)="filtroStato = $event">
            </app-scelta-tendina>
        </div>
    </div>
    </div>
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
      @if (veicoli === null) {
        <div class="col-span-full py-24 flex flex-col items-center justify-center">
          <div class="relative">
              <i class="bi bi-arrow-clockwise text-4xl text-slate-300 animate-spin inline-block"></i>
            </div>
        </div>
      } @else {
      @for (veicolo of veicoliFiltrati; track veicolo.targaVeicolo) {
        <app-card-auto-aziendale
          [veicolo]="veicolo"
          (apriDettagli)="apriModaleDettagli($event)">
        </app-card-auto-aziendale>
      }
      @if (veicoliFiltrati?.length === 0) {
        <div class="col-span-full py-16 text-center">
          <div class="w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4 text-slate-400">
            <i class="bi-search text-3xl"></i>
          </div>
          <h3 class="text-lg font-bold text-slate-700">Nessun veicolo trovato</h3>
          <p class="text-grigio-scuro text-sm">Prova a cambiare i filtri di ricerca.</p>
          <button (click)="resetFiltri()" class="mt-4 text-blue-600 font-semibold hover:underline text-sm">
            Resetta filtri
          </button>
        </div>
      }}
    </div>
  </div>
  </div>

  @if (mostraModale) {
    <app-modale-gestisci-veicolo
      (inviaLuogo)="impostaLuogo($event)"
    (richiediVeicolo)="caricaDettagliVeicolo($event)"
    [loading]="loading"
    [veicoloInput]="veicoloSelezionato"
    [listaLuoghi]="listaLuoghi"  (chiudi)="chiudiModale()"
    >
  </app-modale-gestisci-veicolo>
    }
</app-template-titolo-sottotitolo>
@if (erroreBanner) {
  <app-banner-errore [errore]="erroreBanner" (chiudi)="erroreBanner=''"></app-banner-errore>
}
@if(successoBanner){
  <app-banner-errore [successo]="successoBanner" (chiudi)="successoBanner=''"></app-banner-errore>
}
