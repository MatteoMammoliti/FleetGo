<app-template-titolo-sottotitolo
  titolo="Bentornato {{nomeECognomeAdmin}}"
  sottotitolo="Ecco il riepilogo delle attivitÃ  e lo stato della tua flotta."
  [testoDestro]="nomeAziendaGestita">

  <div class="mb-8 grid grid-cols-1 lg:grid-cols-12 gap-6 mt-6 px-3">

    <div class="lg:col-span-8 bg-white rounded-[2rem] p-6 shadow-md border border-grigio/50">
      <div class="flex items-center justify-between mb-3">
        <h3 class="text-lg font-bold text-testo-p flex items-center gap-3">
          <span class="w-1.5 h-6 bg-azzurro rounded-full"></span>
          Centro Notifiche e Richieste
        </h3>

        @if (sommaRichieste > 0) {
          <div class="relative flex items-center">
            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-azzurro opacity-20"></span>
            <div class=" bg-azzurro text-white text-xs font-black px-2 py-1 rounded-full shadow-lg shadow-azzurro/30">
              {{ sommaRichieste }}
            </div>
          </div>
        }
      </div>
      <div class="h-[200px] animate-fade-left animate-once animate-duration-1000">
        <app-carosello-richieste-miste
        [contatoreRichiesteAffiliazioneInAttesa]="contatoreRichiesteAffiliazione"
        [contatoreRichiesteNoleggioInAttesa]="contatoreRichiesteNoleggio"
        [contatoreFattureDaPagare]="contatoreFattureDaPagare">
      </app-carosello-richieste-miste>
      </div>
    </div>

    <div class="lg:col-span-4 h-full ">
      <app-grafico-torta-flotta
        [inUso]="veicoliInUso"
        [disponibili]="veicoliDisponibili"
        [inManutenzione]="veicoliInManutenzione">
      </app-grafico-torta-flotta>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 mb-6 ml-6 px-3 items-stretch">

    <div class="lg:col-span-4 flex flex-col h-full">
      <div class="flex flex-col gap-3 flex-1">

      <h3 class="text-lg font-bold text-testo-p mb-4 flex items-center gap-2">
        <span class="w-1.5 h-6 bg-blu opacity-100 rounded-full"></span>
        Statistiche Rapide
      </h3>
      <div class="flex flex-col gap-3">
        <app-card-statistiche-dashboard-fleet
        titolo="Spesa Mensile"
        [valore]="(statisticheGuadagno | currency:'EUR':'symbol':'1.2-2')!"
        descrizione="Costi flotta del mese"
        icona="bi-wallet2">
      </app-card-statistiche-dashboard-fleet>

        <app-card-statistiche-dashboard-fleet
          titolo="Veicoli senza luogo"
          [valore]="statisticheFlotta"
          descrizione="Asssegna un luogo per attivare i veicoli"
          icona="bi-car-front">
        </app-card-statistiche-dashboard-fleet>
      </div>
      </div>

    </div>

    <div class="lg:col-span-8 flex flex-col h-full">
      <h3 class="text-lg font-bold text-testo-p mb-4 flex items-center gap-2">
        <span class="w-1.5 h-6 bg-testo-s opacity-20 rounded-full"></span>
        Offerte Attive
      </h3>
      <div class="flex flex-col justify-center flex-1">
        <div class="bg-white rounded-[2rem] p-2 shadow-md border border-grigio/50 overflow-hidden flex-1 animate-fade-left animate-once animate-duration-1000">
          <app-carosello-offerte
            [offerte]="offerteAttive"
            (offertaSelezionata)="apriModaleRichiestaAppuntamento($event)">
          </app-carosello-offerte>
        </div>
      </div>

    </div>

  </div>
</app-template-titolo-sottotitolo>

@if (modaleAppuntamentoVisibile) {
  <app-modale-richiesta-appuntamento
    [offertaSelezionata]="offertaSelezionata"
    [appuntamentoRichiesto]="richiesteContattoInCorso.has(offertaSelezionata.idOfferta)"
    (chiudiPagina)="chiudiModaleRichiestaAppuntamento()"
    (richiediAppuntamento)="richiediAppuntamento()">
  </app-modale-richiesta-appuntamento>
}


@if (nessunaSedeImpostata) {
  <app-modale-obbligo-impostazione-sede
    (impostaSede)="impostaSede($event)">
  </app-modale-obbligo-impostazione-sede>
}
