<div class="absolute top-6 left-6 z-10 pointer-events-none">
  <div class="flex items-center gap-3 mb-1">
    <div class="p-2 bg-azzurro rounded-full shadow-lg">
      <i class="bi bi-geo-alt-fill text-white text-sm"></i>
    </div>
    <h3 class="text-white font-bold text-xl tracking-wide drop-shadow-md">Mappa Hub Attivi</h3>
  </div>
  <p class="text-slate-200 text-sm font-medium drop-shadow-md ml-1">
    Visualizza le {{ luoghiAzienda ? luoghiAzienda.length : 0 }} sedi disponibili.
  </p>
</div>

<div class="w-full h-full">
  @if (apiCaricata) {
    <google-map
      width="100%"
      height="100%"
      [center]="center"
      [zoom]="zoom"
      [options]="mapOptions">

      @for (hub of luoghiAzienda; track hub.idLuogo) {
        <map-marker
          [position]="{ lat: hub.latitudine, lng: hub.longitudine }"
          (mapClick)="openInfo(markerRef, hub)"
          #markerRef="mapMarker">
        </map-marker>
      }

      <map-info-window (closeclick)="resetMappa()">
        @if (hubSelezionato) {
          <div class="p-2 text-blu">
            <h4 class="font-bold text-base mb-1">{{ hubSelezionato.nomeLuogo }}</h4>
          </div>
        }
      </map-info-window>

    </google-map>
  } @else {
    <div class="w-full h-full flex flex-col items-center justify-center bg-blu animate-pulse">
      <div class="spinner border-4 border-azzurro border-t-transparent rounded-full w-10 h-10 mb-3 animate-spin"></div>
      <span class="text-slate-400 text-sm">Caricamento mappa...</span>
    </div>
  }
</div>

<div class="absolute bottom-6 left-6 z-10 pointer-events-auto">
  <a href="javascript:void(0)" class="text-azzurro bg-white/90 hover:bg-white px-4 py-2 rounded-full text-sm font-bold shadow-lg transition-all flex items-center gap-2">
    Apri Mappa Interattiva <i class="bi bi-arrow-right"></i>
  </a>
</div>
