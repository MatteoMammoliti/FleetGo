<app-intestazione-ebackground titolo="Aziende Affiliate">

  <div class="flex flex-col xl:flex-row justify-between items-end xl:items-center gap-4">

    <div class="relative w-full xl:w-96">
      <i class="bi-search absolute left-4 top-1/2 -translate-y-1/2 text-slate-400"></i>
      <input type="text" placeholder="Cerca per nome o partita IVA..."
             [(ngModel)]="testoRicerca"
             class="w-full pl-11 pr-4 py-3 rounded-xl border border-slate-200 bg-white text-slate-700 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all shadow-sm">
    </div>

    <div class="flex flex-wrap items-center gap-3 w-full xl:w-auto justify-end">

      <div class="bg-slate-100 p-1 rounded-xl flex border border-slate-200">

        <button (click)="impostaVista(false)"
                class="px-4 py-2 rounded-lg text-sm font-bold transition-all flex items-center gap-2"
                [class.bg-white]="!mostraAziendeArchiviate"
                [class.text-blue-600]="!mostraAziendeArchiviate"
                [class.shadow-sm]="!mostraAziendeArchiviate"
                [class.text-slate-500]="mostraAziendeArchiviate"
                [class.hover:text-slate-700]="mostraAziendeArchiviate">
          <i class="bi bi-building-check"></i>
          Attive
        </button>

        <button (click)="impostaVista(true)"
                class="px-4 py-2 rounded-lg text-sm font-bold transition-all flex items-center gap-2"
                [class.bg-white]="mostraAziendeArchiviate"
                [class.text-red-600]="mostraAziendeArchiviate"
                [class.shadow-sm]="mostraAziendeArchiviate"
                [class.text-slate-500]="!mostraAziendeArchiviate"
                [class.hover:text-slate-700]="!mostraAziendeArchiviate">
          <i class="bi bi-archive-fill"></i>
          Archivio
          @if (listaAziendeDisabilitate && listaAziendeDisabilitate.length > 0) {
            <span class="bg-slate-200 text-slate-600 text-[10px] px-1.5 py-0.5 rounded-full">
              {{ listaAziendeDisabilitate.length }}
            </span>
          }
        </button>
      </div>

      <button (click)="gestisciVisibilitaModaleAggiuntaAziende()"
              class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-3 rounded-xl transition-all flex items-center justify-center gap-2 active:scale-95 shadow-lg shadow-blue-100 ml-2">
        <i class="bi-plus-lg text-lg"></i>
        <span>Nuova Azienda</span>
      </button>
    </div>
  </div>

  <div class="bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden transition-all duration-300 mt-3 mb-5">

    <div class="px-6 py-4 border-b border-slate-100 bg-slate-50/50 flex justify-between items-center">
      <h3 class="font-bold flex items-center gap-2 transition-colors"
          [class.text-slate-700]="!mostraAziendeArchiviate"
          [class.text-red-600]="mostraAziendeArchiviate">
        @if (!mostraAziendeArchiviate) {
          <i class="bi bi-building-check text-azzurro"></i> Aziende Attive
        } @else {
          <i class="bi bi-archive text-red-500"></i> Archivio Disabilitate
        }
      </h3>
      <span class="text-xs font-semibold text-slate-400 uppercase tracking-wider">
        {{ filtraAziende?.length }} risultati
      </span>
    </div>


    <app-tabella-aziende
      #tabellaAziende
      [listaAziende]="filtraAziende"
      [modalitaArchivio]="mostraAziendeArchiviate"
      (disabilitaAzienda)="disabilitaAzienda($event)"
      (riabilitaAzienda)="riabilitaAzienda($event)">
    </app-tabella-aziende>
  </div>

  @if(mostraModale) {
          <app-form-aggiungi-admin-azienda
            #formAggiungiAdminAzienda
            (aziendaAggiunta)="onAziendaAggiunta($event)"
            (chiudi)="mostraModale=false">
          </app-form-aggiungi-admin-azienda>
  }

</app-intestazione-ebackground>

@if (erroreBanner) {
  <app-banner-errore [errore]="erroreBanner" (chiudi)="erroreBanner=''"></app-banner-errore>
}
@if(successoBanner){
  <app-banner-errore [successo]="successoBanner" (chiudi)="successoBanner=''"></app-banner-errore>
}

